---
import FeatureCard from './FeatureCard.astro';
import { features } from '../data/features';
---

<section id="fitur" class="py-16 md:py-24 bg-background-light dark:bg-background-dark transition-colors duration-300">
  <div class="px-4 md:px-10 lg:px-40 max-w-[1440px] mx-auto">
    <!-- Section Header with Animation -->
    <div class="flex flex-col gap-2 mb-12 scroll-animate-feature" data-animation="fade-in-up">
      <h2 class="text-text-primary dark:text-white text-3xl font-bold leading-tight tracking-tight">
        Kenapa Memilih NASYA?
      </h2>
      <p class="text-gray-500 dark:text-gray-400 text-lg">
        Keunggulan kami yang membuat ribuan siswa lulus dengan percaya diri.
      </p>
    </div>
    
    <!-- Feature Cards Grid with Staggered Animation -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {features.map((feature, index) => (
        <div 
          class="scroll-animate-feature" 
          data-animation="scale-in" 
          data-delay={index * 150}
        >
          <FeatureCard feature={feature} />
        </div>
      ))}
    </div>
  </div>
</section>

<script>
  // Intersection Observer for feature scroll animations
  function initFeatureAnimations() {
    const animatedElements = document.querySelectorAll('.scroll-animate-feature');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const el = entry.target as HTMLElement;
          const animation = el.dataset.animation || 'fade-in-up';
          const delay = parseInt(el.dataset.delay || '0');
          
          setTimeout(() => {
            el.classList.add('is-visible');
            el.classList.add(`animate-${animation}`);
          }, delay);
          
          observer.unobserve(el);
        }
      });
    }, {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    });
    
    animatedElements.forEach(el => {
      (el as HTMLElement).style.opacity = '0';
      observer.observe(el);
    });
  }
  
  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFeatureAnimations);
  } else {
    initFeatureAnimations();
  }
</script>
